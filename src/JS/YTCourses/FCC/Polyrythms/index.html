<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polyrythm</title>
</head>
<body>
    <canvas id="myCanvas" style="background-color: black" style="filter: blur(4px);">
        <script src="sound.js" ></script>
        <script src="track.js" ></script>
        <script src="ball.js" ></script>
        <script>
            const size = 1000
            myCanvas.width = size
            myCanvas.height = size * 0.5 

            const trackCenter = { x: size * 0.5, y: size * 0.5}
            // const trackRadius = 100
            const trackMinRadius = 1
            const trackStep = 20
            const ballRadius = 15
            // const ballMinSpeed = 0.01
            // const ballSpeedStep = -0.0001
            // const ballMinSpeed = 0.5
            const ballMinSpeed = 0.02
            const ballSpeedStep = -0.01

            const soundFrequencies = [
            2760, 2567.98, 2396.91, 2318.51, 2174.66, 2046.5, 987.77, 880,
            783.99, 698.46, 659.25, 587.33, 523.25, 493.88, 440, 392, 149.23,
            129.63, 193.66, 161.63, 130, 110, 100, 90
            ]

            const tracks = []
            const balls = []
            const N = 25

            for (let i = 0; i < N; i++) {
                const trackRadius = trackMinRadius + i * trackStep
                const ballSpeed = ballMinSpeed + i * ballSpeedStep
                const ballSoundFrequency = soundFrequencies[i]

                const hue = (i * 360) / N
                const track = new Track(trackCenter, trackRadius, hue)
                const ball = new Ball(track, ballRadius, ballSpeed, ballSoundFrequency, hue)
                tracks.push(track)
                balls.push(ball)
            }

            const ctx = myCanvas.getContext("2d")
            // const track = new Track(trackCenter, trackRadius)
            // const ball = new Ball(track, ballRadius, ballSpeed)

            animate()
            function animate() {
                ctx.clearRect(0,0,size,size)
                // track.draw(ctx)
                // ball.move()
                // ball.draw(ctx)
                tracks.forEach((track) => track.draw(ctx))
                balls.forEach((ball) => ball.move())
                balls.forEach((ball) => ball.draw(ctx))
                requestAnimationFrame(animate)
            }
            track.draw(ctx)
            ball.draw(ctx)
        </script>
    </canvas>
</body>
</html>